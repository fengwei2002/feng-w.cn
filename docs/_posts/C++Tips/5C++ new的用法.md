---
title: C++ new 的用法
date: 2020-09-07
category: basics
tags:
  - C++
---

很容易忘啊，所以决定总结一次，要不然每次都得百度找

通常来说，当在局部函数中 new 出一段新的空间，该段空间在局部函数调用结束后仍然能够使用，可以用来向主函数传递参数。另外需要注意的是，new 的使用格式，new 出来的是一段空间的首地址。所以一般需要用指针来存放这段地址。

```cpp
//开辟一个空间后直接赋值，一般不用，因为数据类型一般都有默认的声明方式
int *p = new int(3);
//如果一个变量不想使用* p 的方式来使用
//那么可以定义一个变量，在 new 之前用“*”表示 new 出来的内容
  int q = *new int;
  q = 1;

//当 new 一个数组时，同样用一个指针接住数组的首地址，开辟空间后使用 for 循环赋值
  int *q = new int[3];//开辟3个int的空间

//new对结构体数组的使用
//student中含有两个私有变量name和sorce
  student *stlist = new student[3]{{"abc", 90}, {"bac", 78}, {"ccd", 93}};

//使用new开辟二维数组，一种是需要先开辟行，再开辟列
int **p = new int*[m]; //开辟行
	for(int i = 0; i < m; i++)
		p[i] = new int[n]; //开辟列  可以直接[][]访问。但是内存不连续，不是很推荐使用，除非M\N都不确定

//二维向量 tip：
vector<vector<char> >vec(n,vector<char>(m,'#'));

//删除new出来的二维数组：
for (int j = 0; j<M; j++){
    delete[]pNum[j];//删除尾指针
}
delete[]pNum;//删除头指针

//2：内存连续，但是不能[][]，最推荐的一种。不能[][]但是你可以通过[i*n+j]来计算  啊
//这种是1维数组转化为2维数组
int* a = new int[M*N];
// a[i*n+j]是a[i][j]，使用不是很方便，但是实际空间中内存连续
delete[]a;

//3：
//内存不连续，可以[][],是第一种情况的特例，局限性比较大，比第一种好在能直接delete，方便
//如果你确实知道N是多少，那么可以用这种，比如说二维数组做形参的时候(此时内存连续)，不是很推荐使用
int(*pNum)[N] = new  int[M][N];
delete[] pNum;
```
目前就知道这么多，以后遇到再加